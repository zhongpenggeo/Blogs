## 等效积分弱形式

#### 1. 等效积分

等效积分可以弱化解的光滑性，要求：

1. V在$\Omega$上可积

2. $\phi$只需要**n-1阶导数连续即**可，也就是n阶存在（而无需连续）（古典解需要n阶连续），


因为对于积分，只要n阶导数存在，且只有有限个尖端点即可以积分。

以二维稳态热传导方程为例：

![image-20201205170443923](../imags/image-20201205170443923.png)

上述两式可以写为以下等效积分形式：

![image-20201205170610518](../imags/image-20201205170610518.png)

其中，$v$和$\overline{v}$是任意的标量函数，并假设$\Gamma_\phi$上的边界条件：

$$\phi - \overline{\phi}=0$$

在选择函数$\phi$时已经自动满足，这叫做强制边界条件

#### 2. 弱形式

这里进一步降低光滑性。**只需要n-1阶导数存在且只有有限个间断点**。这里的降低是以提高函数$v$的连续性为代价的。 

对积分第一项进行分部积分：

![image-20201205171034246](../imags/image-20201205171034246.png)

那么1.2.10式变成：

![image-20201205171229414](../imags/image-20201205171229414.png)

其中：

![image-20201205171206544](../imags/image-20201205171206544.png)

对于任意函数$v$和$\overline{v}$，可以不失一般性地假定：

$$v=-\overline{v}$$

注意：这里的边界$\Gamma=\Gamma_\phi+\Gamma_q$；所以边界的导数项可以正负约去；得到：

![image-20201205171415295](../imags/image-20201205171415295.png)





![image-20201205191324714](../imags/image-20201205191324714.png)

![image-20201205191335555](../imags/image-20201205191335555.png)

#### 3. 其他

1. 弱形式：![image-20201205171513175](../imags/image-20201205171513175.png)
2. 自然边界条件是自动满足的（？？）
3. ![image-20201205171549055](../imags/image-20201205171549055.png)

参考：

[有限元程序自动生成系统 (pudn.com)](http://read.pudn.com/downloads154/ebook/683455/%D3%D0%CF%DE%D4%AA%B7%BD%B7%A8(%D3%D0FORTRAN%B3%CC%D0%F2).pdf)

<<有限单元发基本原理和数值方法(第二版)>>