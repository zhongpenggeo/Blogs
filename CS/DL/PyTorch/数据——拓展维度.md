## pytorch

### 复制维度

```python
>>> x= torch.randn(2,3)
>>> x.repeat(3,4).shape
torch.Size([6, 12])
```

torch.repeat和np.title用法相同

### 增加维度

```python
>>> x.unsqueeze(0).shape
torch.Size([1, 2, 3])
>>> x.unsqueeze(1).shape
torch.Size([2, 1, 3])
>>> x.unsqueeze(2).shape
torch.Size([2, 3, 1])

# 多个维度
>>> x[:,:,None,None].expand([2,3,1,1])
torch.Size([2, 3, 1, 1])
# or
>>> x[:,:,None,None].repeat([1,1,1,1])

```

repeat和expand的区别：repeat会拷贝，expand相当于view

### 减少多余的维度

```python
>>> x.repeat(1,1,1).squeeze(2).shape
torch.Size([1, 2, 3])
>>> x.repeat(1,1,1).squeeze(0).shape
torch.Size([2, 3])

>>> x.unsqueeze(1).repeat(1,1,1).shape
torch.Size([2, 1, 3])
>>> x.unsqueeze(1).repeat(1,1,1).squeeze(1).shape
torch.Size([2, 3])
```



## numpy

### 复制维度

```python
>>> a=np.random.randn(2,3)
>>> np.tile(a, 2).shape
(2, 6)
>>> np.tile(a, (2,2)).shape
(4, 6)
>>> np.tile(a, (1,2,2)).shape
(1, 4, 6)
```

注意numpy的repeat和torch的repeat不一样

```python
>>> a
array([[ 0.98216918, -1.14163387,  1.96464766],
       [-0.06904607,  0.41498282, -0.06047444]])
>>> a.repeat(3,axis=0)
array([[ 0.98216918, -1.14163387,  1.96464766],
       [ 0.98216918, -1.14163387,  1.96464766],
       [ 0.98216918, -1.14163387,  1.96464766],
       [-0.06904607,  0.41498282, -0.06047444],
       [-0.06904607,  0.41498282, -0.06047444],
       [-0.06904607,  0.41498282, -0.06047444]])
```

### 增加维度

```python
>>> np.expand_dims(a,axis=0).shape
(1, 2, 3)
>>> np.expand_dims(a,axis=1).shape
(2, 1, 3)
>>> np.expand_dims(a,axis=2).shape
(2, 3, 1)
#多个维度
>>> np.expand_dims(a0,[0,2]).shape
(1, 2, 1, 3)
```



### 减少多余的维度

```python
>>> np.expand_dims(a,axis=2).shape
(2, 3, 1)
>>> np.expand_dims(a,axis=2).squeeze(2).shape
(2, 3)
```

