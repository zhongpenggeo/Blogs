### 求解器

求解器可能是正反演问题中最大的性能瓶颈

simpeg的求解器有两种，一种是Pardiso Solver，一种是scipy中求解器的Warp

### Pardiso

直接求解器的一种，对于所有良态有限元问题，这些求解器都能得到相同的答案，这就是它们最大的优势；

不同直接求解器之间的主要区别在于其相对速度。MUMPS、PARDISO 和 SPOOLES 求解器每个都可以利用单台机器上的所有处理器内核，但 PARDISO 最快，SPOOLES 最慢。在所有直接求解器中，SPOOLES 使用的内存最少。所有直接求解器都需要使用大量的 RAM，但 MUMPS 和 PARDISO 可以在*核外*储存解，这意味着它们能够将部分问题卸载到硬盘上。MUMPS 求解器也支持集群计算，使您可用的内存大于通常任一台机器中所能提供的。

如果您在求解一个没有解的问题，例如没有约束却有载荷的结构力学问题，直接求解器仍会尝试求解，但会返回一个与下方所示类似的错误信息：

```
求解失败。
相对残差（0.06）大于相对容差。
返回的结果未收敛。
```

### 调用scipy

可以调用scipy中的直接求解器和迭代求解器

有两个Wrap

- SolverWrapD 调用直接求解器
- SolverWrapI 调用迭代求解器

预定义的一些求解器，

```python
Solver = SolverWrapD(linalg.spsolve, factorize=False, name="Solver")
SolverLU = SolverWrapD(linalg.splu, factorize=True, name="SolverLU")
SolverCG = SolverWrapI(linalg.cg, name="SolverCG")
SolverBiCG = SolverWrapI(linalg.bicgstab, name="SolverBiCG")
```



```python
from SimPEG import Solver
```



### 测试结果

Pardiso速度还可以，但比fortran程序还是慢个10倍左右。

但是其他调用的scipy都非常慢；

[simpeg/solver_utils.py at main · simpeg/simpeg (github.com)](https://github.com/simpeg/simpeg/blob/main/SimPEG/utils/solver_utils.py#L115-L198)

[Solver — SimPEG 0.16.0 documentation](http://docs.simpeg.xyz/content/api_core/api_Solver.html)

