### 进程

编译生成的程序，运行后就是一个进程。

进程拥有**独立的地址空间**。

- 程序：存储在磁盘上的一个文件，是指令和数据的[集合](https://so.csdn.net/so/search?q=集合&spm=1001.2101.3001.7020)，是一个**静态**的概念
- 进程：程序加载到内存运行后一些列的活动，是一个**动态**的概念。

### 内核模式与用户模式

- 内核空间：存放的是操作系统内核代码和数据，是被所有程序**共享**的；操作系统禁止用户程序直接访问内核空间
- API函数：执行内核提供的代码，让内核自己来访问内核空间，保证内核空间的数据不被随意修改。

#### 内核模式

用户程序调用系统 API 函数称为系统调用（System Call）；发生系统调用时会暂停用户程序，转而执行内核代码（内核也是程序），访问内核空间

#### 用户模式

用户空间保存的是应用程序的代码和数据，是程序私有的，其他程序一般无法访问。当执行应用程序自己的代码时，称为用户模式

#### 切换

- 当运行在用户模式的应用程序需要输入输出、申请内存等比较底层的操作时，就必须调用操作系统提供的 API 函数，从而进入内核模式；
- 操作完成后，继续执行应用程序的代码，就又回到了用户模式。

### 为何共用地址空间

**让内核拥有完全独立的地址空间，就是让内核处于一个独立的进程中，这样每次进行系统调用都需要切换进程。切换进程的消耗是巨大的，不仅需要寄存器进栈出栈，还会使CPU中的数据缓存失效、MMU中的页表缓存失效，这将导致内存的访问在一段时间内相当低效**

而让内核和用户程序共享地址空间，发生系统调用时进行的是模式切换，模式切换仅仅需要寄存器进栈出栈，不会导致缓存失效；现代CPU也都提供了快速进出内核模式的指令，与进程切换比起来，效率大大提高了。